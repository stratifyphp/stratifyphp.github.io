<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Stratify - Your application, your architecture</title>

            <link href="http://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
        <link href="http://stratifyphp.github.io/css/highlight.github.css" rel="stylesheet">
        <link href="http://stratifyphp.github.io/css/all.min.css" rel="stylesheet">
    </head>
<body>

    <header>
        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://stratifyphp.github.io/">Stratify</a>
                </div>
                <div class="collapse navbar-collapse" id="top-navigation">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://stratifyphp.github.io/docs/">Documentation</a></li>
                        <li><a href="http://stratifyphp.github.io/middlewares/">Middlewares</a></li>
                        <li><a class="github" href="https://github.com/stratifyphp"><i class="fa fa-github"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    
    <div class="container documentation">

        <div class="sidebar">
            <ul>
                                    <li>
                        Components

                        <ul>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/component/http.html">
                                        Http
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/component/router.html">
                                        Router
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Framework

                        <ul>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/getting-started.html">
                                        Getting started
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/modules.html">
                                        Modules
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/extended-callables.html">
                                        Extended callables
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/templating.html">
                                        Templating
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                            </ul>
        </div>

        <article>
            <h1 id="the-http-component">The Http component</h1>
<p>The Http component is a non-opinionated package to write an HTTP application. Unlike the whole Stratify framework, it provides only the generic core of an HTTP application. It makes it good for:</p>
<ul>
<li>building very fast and lightweight micro-services or micro-applications</li>
<li>building your application with your own architecture</li>
<li>building a framework on top of it</li>
</ul>
<h2 id="concept">Concept</h2>
<p>The Http package relies on a single concept: <strong>middlewares</strong>. An HTTP application runs by simply <strong>calling a middleware</strong>.</p>
<pre><code class="language-php">$app = new Application($middleware);
$app-&gt;run();</code></pre>
<p>The simplest middleware could look like this:</p>
<pre><code class="language-php">$middleware = function (ServerRequestInterface $request, ResponseInterface $response, callable $next) {
    $response-&gt;getBody()-&gt;write('Hello world!');
    return $response;
}
$app = new Application($middleware);
$app-&gt;run();</code></pre>
<p>You will note that such an application doesn't contain any router. The application is extremely simple and makes no assertion for you. If you don't need a router, you can avoid the overhead of it.</p>
<p>You could also consider implementing your own very specific router (and optimize it to your heart's content):</p>
<pre><code class="language-php">$middleware = function (ServerRequestInterface $request, ResponseInterface $response, callable $next) {
    switch ($request-&gt;getRequestTarget()) {
        case '/':
            $response-&gt;getBody()-&gt;write('Home');
            break;
        case '/deploy':
            $response-&gt;getBody()-&gt;write('Deploying');
            break;
        default:
            return $next($request, $response);
    }
    return $response;
};</code></pre>
<p>As you can see, a lot of freedom and no overhead.</p>
<h2 id="composing-middlewares">Composing middlewares</h2>
<p>Writing an application with one callable can work for very specific micro-services, but can be limited. If you want to create a more complex application, you can take full advantages of middlewares by piping them.</p>
<pre><code class="language-php">$middleware = new MiddlewarePipe([

    function ($request, $response, $next) {
        $res-&gt;getBody()-&gt;write('Hello');
        return $next($req, $res);        // call the next middleware
    },

    function ($request, $response, $next) {
        $res-&gt;getBody()-&gt;write(' world');
        return $res;
    },

]);

$app = new Application($middleware);
$app-&gt;run();
// The application will always return "Hello world" as a response</code></pre>
<p>Each middleware in the pipe must return a response. To do this, it can either:</p>
<ul>
<li>build the response</li>
<li>call the next middleware in the pipe and return the result</li>
<li>call the next middleware in the pipe, play with the response and return it</li>
</ul>
<p>That allows you to add any behavior you want <strong>before or after</strong> the request is processed by another middleware. You can also intercept and stop the application flow to reach the next middleware.</p>
<p>For example, you may want to use an authentication middleware to prevent un-authorized access to your application.</p>
        </article>

    </div>


            <footer>
            <div class='container'>
                                    <p>
                        A question? Unsatisfied with the documentation?
                        Please <a href="https://github.com/PHP-DI/PHP-DI/issues/new">create an issue</a>
                        or chat on
                        <a href="https://gitter.im/PHP-DI/PHP-DI">Gitter</a> or
                        <a href="https://twitter.com/phpdi">Twitter</a>.
                    </p>
                                <p>
                    By <a href="http://mnapoli.fr/">Matthieu Napoli</a>
                    and <a href="https://github.com/PHP-DI/PHP-DI/graphs/contributors">contributors</a>
                    |
                    Website generated with
                    <a href="http://mnapoli.fr/Couscous/" target="_blank">Couscous</a>.
                </p>
            </div>
        </footer>
    
            <script src="http://stratifyphp.github.io/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="http://stratifyphp.github.io/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>

        <script>
            $(function() {
                hljs.initHighlightingOnLoad();
            });
        </script>
    
</body>
</html>
