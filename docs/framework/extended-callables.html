<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Stratify - Your application, your architecture</title>

            <link href="http://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
        <link href="http://stratifyphp.github.io/css/highlight.github.css" rel="stylesheet">
        <link href="http://stratifyphp.github.io/css/all.min.css" rel="stylesheet">
    </head>
<body>

    <header>
        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://stratifyphp.github.io/">Stratify</a>
                </div>
                <div class="collapse navbar-collapse" id="top-navigation">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="http://stratifyphp.github.io/docs/">Documentation</a></li>
                        <li><a href="http://stratifyphp.github.io/middlewares/">Middlewares</a></li>
                        <li><a class="github" href="https://github.com/stratifyphp"><i class="fa fa-github"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    
    <div class="container documentation">

        <div class="sidebar">
            <ul>
                                    <li>
                        Components

                        <ul>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/component/http.html">
                                        Http
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/component/router.html">
                                        Router
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        Framework

                        <ul>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/getting-started.html">
                                        Getting started
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/modules.html">
                                        Modules
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="http://stratifyphp.github.io/docs/framework/extended-callables.html">
                                        Extended callables
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                            </ul>
        </div>

        <article>
            <h1 id="extended-callables">Extended callables</h1>
<h2 id="classic-php-callables">Classic PHP callables</h2>
<p>PHP has the concept of <a href="http://php.net/manual/en/language.types.callable.php"><strong>callables</strong></a>, i.e. something that can be invoked.</p>
<p>Here is a (non-exhaustive) list of valid PHP callables:</p>
<pre><code class="language-php">// Closure
$callable = function() { ... }

// Function
function my_function() { ... }
$callable = 'my_function';

// Static method
class MyClass
{
    public static function foo() { ... }
}
$callable = ['MyClass', 'foo'];

// Method
class MyClass
{
    public function foo() { ... }
}
$callable = [new MyClass(), 'foo'];

// Invokable class
class MyClass
{
    public function __invoke() { ... }
}
$callable = new MyClass();</code></pre>
<p>PHP callables can be invoked simply:</p>
<pre><code class="language-php">$callable();</code></pre>
<h2 id="extended-callables-1">Extended callables</h2>
<p>Using PHP callables in a framework (e.g. for controllers) is great because it lets the user free to choose which form to use. For example it allows to start very easily with closures and then move to classes when the application grows.</p>
<p>However <strong>this is limited</strong>: using an invokable class or object method as a controller means you have to create the object (<code>[new MyClass(), 'foo']</code> or <code>new MyCallableClass()</code>):</p>
<ul>
<li>performance-wise this means a lot of objects are created during the application's bootstrap and maybe not used</li>
<li>it's harder to use dependency injection in controllers</li>
</ul>
<p>To solve these issues, Stratify introduces the concept of <strong>extended callables</strong>: these callables are not actual PHP callables, but they reuse the same principles.</p>
<p>For those familiar with other frameworks, this is a friendlier alternative to custom notations to define controllers as services (e.g. <code>Acme\App\UserController:list</code> in <a href="http://symfony.com/doc/current/cookbook/controller/service.html#referring-to-the-service">Symfony</a>, <a href="https://github.com/slimphp/Slim/blob/3.x/Slim/CallableResolver.php#L50-L51">Slim</a>, <a href="http://silex.sensiolabs.org/doc/providers/service_controller.html#usage">Silex</a>, <code>Acme\App\UserController@list</code> in <a href="http://laravel.com/docs/5.1/controllers#basic-controllers">Laravel</a>, <code>Acme\App\UserController::list</code> in ZF2, â€¦).</p>
<h3 id="object-method-call">Object method call</h3>
<p>The PHP callable for a method call is <code>[new MyClass(), 'foo']</code>. The extended callable for this is:</p>
<pre><code class="language-php">class MyClass
{
    public function foo() { ... }
}

$callable = [MyClass::class, 'foo'];</code></pre>
<p>The first item of the array can be <em>any container entry</em>. That means it can be a class name or anything else (e.g. <code>['db', 'getConnection']</code>).</p>
<p>When the callable is invoked, the object <strong>will be created by the container</strong> (so you can use any dependency injection feature). That is equivalent to the following code:</p>
<pre><code class="language-php">$object = $container-&gt;get(MyClass::class);
// Now we have a valid PHP callable
$callable = [$object, 'foo'];</code></pre>
<p>You might notice that this notation is similar to a <em>static</em> method call <code>['Foo', 'bar']</code>. It is indeed the same. However there is no collision: if the method is static, then the method will be invoked statically without creating an instance. If the method is not static, then it's an <em>extended callable</em>.</p>
<h3 id="invokable-class">Invokable class</h3>
<p>The PHP callable for an invokable class (implementing <code>__invoke()</code>) is <code>new MyClass()</code>.</p>
<p>The extended callable for this is simply the class name (or <em>any container entry</em>):</p>
<pre><code class="language-php">class MyClass
{
    public function __invoke() { ... }
}

$callable = MyClass::class;</code></pre>
<p>When the callable is invoked, the object <strong>will be created by the container</strong> (so you can use any dependency injection feature), and then invoked.</p>
        </article>

    </div>


            <footer>
            <div class='container'>
                                    <p>
                        A question? Unsatisfied with the documentation?
                        Please <a href="https://github.com/PHP-DI/PHP-DI/issues/new">create an issue</a>
                        or chat on
                        <a href="https://gitter.im/PHP-DI/PHP-DI">Gitter</a> or
                        <a href="https://twitter.com/phpdi">Twitter</a>.
                    </p>
                                <p>
                    By <a href="http://mnapoli.fr/">Matthieu Napoli</a>
                    and <a href="https://github.com/PHP-DI/PHP-DI/graphs/contributors">contributors</a>
                    |
                    Website generated with
                    <a href="http://mnapoli.fr/Couscous/" target="_blank">Couscous</a>.
                </p>
            </div>
        </footer>
    
            <script src="http://stratifyphp.github.io/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="http://stratifyphp.github.io/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>

        <script>
            $(function() {
                hljs.initHighlightingOnLoad();
            });
        </script>
    
</body>
</html>
